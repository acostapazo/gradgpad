import pytest
import numpy as np

from gradgpad.metrics.acer import acer
from gradgpad.metrics.indepth_error_rates_analysis import indepth_error_rates_analysis


@pytest.mark.unit
def test_should_throw_an_exception_when_input_is_not_np_array():
    pytest.raises(
        TypeError,
        lambda: indepth_error_rates_analysis(
            [0.0, 0.2, 0.2, 0.5, 0.6], [1, 2, 2, 0, 0], 0.25
        ),
    )


@pytest.fixture
def given_real_scores_and_labels():
    scores = np.array(
        [
            0.98667376,
            0.78987988,
            0.97666781,
            1.0,
            0.89553994,
            0.82797522,
            1.0,
            0.90906069,
            0.82360794,
            0.83094883,
            0.88784859,
            1.0,
            1.0,
            1.0,
            1.0,
            0.94734152,
            0.93803208,
            0.7393432,
            0.81981907,
            1.0,
            1.0,
            0.8014919,
            0.89377455,
            0.85895852,
            1.0,
            0.7515582,
            0.88704603,
            0.99145245,
            1.0,
            0.84758597,
            0.98326576,
            0.89156473,
            1.0,
            0.86794457,
            0.84061179,
            0.92401211,
            1.0,
            1.0,
            1.0,
            0.98337582,
            1.0,
            0.7718816,
            0.80762835,
            0.91174005,
            1.0,
            1.0,
            1.0,
            0.88119193,
            1.0,
            0.92832923,
            0.91182546,
            1.0,
            1.0,
            0.87957202,
            1.0,
            1.0,
            1.0,
            0.69490613,
            0.83322891,
            1.0,
            1.0,
            0.99958323,
            1.0,
            0.97352115,
            1.0,
            0.85662447,
            0.87778163,
            0.96364779,
            1.0,
            0.87686678,
            0.99985806,
            0.98696889,
            1.0,
            0.84252092,
            1.0,
            1.0,
            1.0,
            0.9109434,
            1.0,
            1.0,
            1.0,
            0.94621029,
            0.76713397,
            1.0,
            1.0,
            1.0,
            0.98763884,
            0.97105052,
            0.93654467,
            0.79317553,
            0.90734329,
            0.98912207,
            0.87653455,
            0.91554841,
            0.9993641,
            1.0,
            1.0,
            0.81735178,
            0.82093855,
            0.94534963,
            1.0,
            1.0,
            1.0,
            0.79908184,
            0.79666574,
            0.87409703,
            0.95735006,
            0.93909445,
            0.99709476,
            1.0,
            0.97200257,
            0.86381841,
            0.95518832,
            0.81182077,
            0.98677162,
            0.97297753,
            0.96527051,
            1.0,
            1.0,
            1.0,
            0.86962458,
            0.7463554,
            0.80699765,
            0.99223499,
            0.83798106,
            1.0,
            1.0,
            0.82637772,
            0.89767421,
            0.77045581,
            1.0,
            0.86897548,
            0.9596427,
            1.0,
            0.9664054,
            0.9331726,
            0.9253333,
            0.82352245,
            0.87198022,
            0.97053949,
            1.0,
            1.0,
            0.99946636,
            0.88643114,
            0.96748531,
            0.82826714,
            0.87188784,
            1.0,
            1.0,
            1.0,
            1.0,
            0.91263912,
            0.92303795,
            0.73165578,
            0.83890328,
            0.99316262,
            1.0,
            1.0,
            0.89994447,
            1.0,
            0.93851876,
            0.78736283,
            0.93589692,
            0.97702018,
            0.85158769,
            0.74907813,
            1.0,
            0.8136496,
            0.84763016,
            0.82358228,
            0.87021365,
            1.0,
            0.84822958,
            1.0,
            1.0,
            0.87113622,
            0.88991546,
            0.87883784,
            0.82572827,
            0.90639116,
            0.93218928,
            0.81345027,
            1.0,
            0.92100912,
            1.0,
            0.79805412,
            0.87962536,
            0.89435628,
            0.958362,
            0.92409562,
            0.71427341,
            0.82902848,
            0.94418634,
            0.87210397,
            1.0,
            0.98088062,
            0.98271011,
            1.0,
            1.0,
            1.0,
            0.92642084,
            0.98528348,
            0.67990371,
            0.97275983,
            1.0,
            1.0,
            1.0,
            0.82756848,
            0.9696005,
            0.91426697,
            0.95229676,
            0.95525387,
            0.97017671,
            0.82689222,
            0.9641739,
            0.86092621,
            0.84374947,
            0.72553048,
            0.84633412,
            0.90451363,
            0.93514029,
            0.96035748,
            0.92822634,
            0.98708489,
            0.87315341,
            0.69255883,
            0.96260841,
            1.0,
            0.94459578,
            1.0,
            1.0,
            0.9163624,
            0.82704829,
            0.78404294,
            0.94356465,
            0.91475423,
            1.0,
            0.93698891,
            0.91405378,
            0.95166272,
            0.96453321,
            0.98374684,
            0.85540404,
            0.91643019,
            1.0,
            0.82854815,
            0.95322055,
            0.95119414,
            0.73310046,
            0.76876719,
            0.84060856,
            0.92633314,
            0.95192357,
            0.93232538,
            1.0,
            0.9676877,
            0.77282773,
            0.87765951,
            0.91775818,
            0.94172339,
            0.97116125,
            0.88329894,
            0.94096937,
            0.98656179,
            1.0,
            0.95796105,
            0.94301669,
            0.86817217,
            0.98982524,
            0.93216543,
            1.0,
            1.0,
            0.85848232,
            0.91344538,
            0.80904972,
            0.91251655,
            0.88507287,
            0.91193579,
            0.92886318,
            0.92828621,
            0.99692186,
            0.9146865,
            0.80111814,
            0.96446389,
            1.0,
            0.90227744,
            0.93524937,
            0.90850685,
            0.90166369,
            0.98110323,
            1.0,
            0.86444001,
            0.93317467,
            0.89562901,
            0.82987863,
            0.98798938,
            0.83223019,
            0.83517798,
            1.0,
            0.91912792,
            0.93405396,
            0.97044913,
            1.0,
            0.86403615,
            0.98746953,
            0.94829968,
            0.94771167,
            1.0,
            1.0,
            0.98602228,
            0.96997137,
            0.9177153,
            1.0,
            0.6490969,
            0.62059398,
            0.72467833,
            0.51537586,
            0.74195054,
            0.71008578,
            0.68663584,
            0.62293373,
            0.70894223,
            0.67726662,
            0.63564355,
            0.57725135,
            0.68275984,
            0.5894033,
            0.55359183,
            0.72372073,
            0.68051105,
            0.74100112,
            0.6630184,
            0.70873187,
            0.68855504,
            0.71644082,
            0.63055325,
            0.63883404,
            0.60597552,
            0.64497699,
            0.62504989,
            0.61334726,
            0.64509185,
            0.58466615,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.96531031,
            1.0,
            0.94752062,
            1.0,
            1.0,
            1.0,
            0.94348866,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.91426195,
            0.96558371,
            0.98415029,
            1.0,
            0.97756032,
            1.0,
            1.0,
            1.0,
            0.95483821,
            0.9030929,
            0.98045586,
            1.0,
            1.0,
            0.85030143,
            1.0,
            1.0,
            0.84518714,
            1.0,
            1.0,
            1.0,
            0.95862447,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.96869691,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.81516353,
            1.0,
            0.98799853,
            1.0,
            1.0,
            0.97209533,
            0.86109235,
            1.0,
            1.0,
            1.0,
            1.0,
            0.98098747,
            0.98380493,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.95009018,
            1.0,
            0.88994734,
            1.0,
            0.89436626,
            1.0,
            0.96259224,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.89701418,
            0.97890655,
            0.90486047,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.98163165,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.92766436,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.92476261,
            1.0,
            0.8646669,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.92528187,
            1.0,
            1.0,
            1.0,
            0.88912292,
            1.0,
            1.0,
            0.98945645,
            1.0,
            1.0,
            1.0,
            0.99309697,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.92151683,
            1.0,
            1.0,
            0.92626955,
            0.97909633,
            0.88146409,
            1.0,
            1.0,
            1.0,
            0.94808448,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.92229806,
            1.0,
            1.0,
            0.91056315,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.96506038,
            1.0,
            1.0,
            1.0,
            0.93545899,
            1.0,
            1.0,
            0.99619534,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.9256382,
            1.0,
            1.0,
            1.0,
            1.0,
            0.97470268,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.91740124,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.99902718,
            0.96843993,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.81067537,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.93474553,
            0.96237831,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.90245392,
            0.988463,
            0.97217635,
            0.961392,
            0.82035325,
            0.86612699,
            0.81749174,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.90028646,
            1.0,
            0.97808073,
            0.91290135,
            0.91871989,
            0.98327051,
            0.79407055,
            1.0,
            1.0,
            0.86478506,
            1.0,
            1.0,
            1.0,
            1.0,
            0.91336805,
            1.0,
            1.0,
            1.0,
            0.9545857,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.77867242,
            1.0,
            0.93458551,
            0.96028096,
            0.82042039,
            1.0,
            1.0,
            1.0,
            0.93860743,
            1.0,
            1.0,
            1.0,
            0.96955099,
            0.94869794,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.94284337,
            1.0,
            0.93597051,
            0.985519,
            1.0,
            0.95047015,
            1.0,
            1.0,
            1.0,
            0.96640242,
            1.0,
            0.80345958,
            1.0,
            0.84390039,
            1.0,
            0.99101864,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.84639767,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.9989,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.93054738,
            0.9843581,
            1.0,
            0.97742322,
            1.0,
            0.88201361,
            1.0,
            1.0,
            1.0,
            0.94829891,
            0.97347496,
            0.85965311,
            1.0,
            1.0,
            0.87871391,
            1.0,
            1.0,
            0.99542427,
            1.0,
            1.0,
            1.0,
            1.0,
            0.9955404,
            1.0,
            0.84270863,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.97684162,
            0.96474846,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.93959285,
            0.86171421,
            0.96865422,
            1.0,
            1.0,
            0.97515878,
            1.0,
            1.0,
            0.92397375,
            1.0,
            1.0,
            0.98419013,
            1.0,
            1.0,
            0.95969038,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.97347228,
            1.0,
            0.93735932,
            0.90179358,
            0.82538612,
            0.87836169,
            0.90111196,
            1.0,
            0.92586118,
            1.0,
            0.98905538,
            0.81046764,
            0.78642892,
            0.89853537,
            0.84761389,
            1.0,
            0.87521866,
            1.0,
            0.99040684,
            1.0,
            1.0,
            0.88910376,
            0.94696892,
            1.0,
            1.0,
            0.7665596,
            0.85223981,
            1.0,
            0.83492544,
            1.0,
            0.87746218,
            1.0,
            1.0,
            0.875865,
            0.88231763,
            0.93709299,
            1.0,
            1.0,
            0.97161038,
            0.93794598,
            0.92784576,
            0.92572998,
            0.91523947,
            0.97475649,
            1.0,
            0.91131332,
            1.0,
            0.86493045,
            1.0,
            0.89671464,
            1.0,
            0.9425446,
            1.0,
            1.0,
            1.0,
            0.98163549,
            0.97388181,
            1.0,
            0.90248932,
            0.86610461,
            1.0,
            0.81688469,
            0.8721378,
            1.0,
            0.87035209,
            0.79914742,
            0.91573974,
            0.82695384,
            1.0,
            0.88252426,
            0.94140859,
            0.88324019,
            0.99332315,
            0.87312279,
            1.0,
            0.94643747,
            0.83489328,
            1.0,
            0.92667123,
            0.92861913,
            0.94326404,
            0.9899798,
            0.86495353,
            1.0,
            0.9216228,
            0.83070029,
            0.88096454,
            0.88751654,
            0.78621951,
            0.80090282,
            0.65008556,
            0.58482741,
            0.9033271,
            1.0,
            0.92343901,
            0.89103364,
            0.67022729,
            0.83650622,
            0.9482601,
            0.6622163,
            0.84687045,
            0.90889638,
            0.95204173,
            0.6245901,
            0.90825981,
            0.73022565,
            0.7479843,
            0.90587553,
            0.73968224,
            0.84495787,
            0.88214744,
            0.69649108,
            0.94323339,
            1.0,
            0.94415402,
            0.97740801,
            0.78000029,
            0.76981203,
            0.77929322,
            0.91825551,
            1.0,
            0.98027561,
            0.81354496,
            0.57217976,
            0.8763707,
            0.93360809,
            0.96564051,
            0.89536015,
            0.9904762,
            0.84267215,
            0.71324784,
            0.84833051,
            0.75182624,
            0.87077955,
            1.0,
            0.81228291,
            1.0,
            0.86447778,
            0.771264,
            0.82455315,
            0.87080908,
            0.77910886,
            0.73162474,
            0.73832633,
            0.77769102,
            0.80819504,
            0.76515181,
            0.87808458,
            0.73846094,
            0.69746536,
            0.83866641,
            0.80855564,
            0.67660268,
            1.0,
            0.86833268,
            0.61405715,
            0.78813681,
            0.84163752,
            0.90243335,
            0.91373185,
            0.9948513,
            0.87147915,
            0.8778353,
            0.77885592,
            0.67646633,
            0.8459885,
            0.93227705,
            0.67160094,
            0.87085395,
            0.73577315,
            0.77045356,
            0.83905244,
            0.81504592,
            0.89307031,
            0.8981539,
            0.89103043,
            0.90899562,
            0.80619467,
            0.82887336,
            0.83126978,
            0.52524408,
            0.90265859,
            0.77091246,
            0.71942278,
            0.86072035,
            0.92278831,
            0.82616214,
            0.94774486,
            0.72052404,
            0.6146745,
            0.93526734,
            0.71602263,
            0.71949691,
            0.82899874,
            0.91785537,
            0.73840772,
            0.92577588,
            1.0,
            0.81427598,
            0.76067788,
            1.0,
            0.86412832,
            0.97557631,
            0.92719774,
            0.78307733,
            0.66531641,
            1.0,
            0.88552791,
            1.0,
            0.9178078,
            0.6916335,
            0.82592236,
            0.81914618,
            1.0,
            0.83983654,
            0.82142664,
            0.94099579,
            0.84240763,
            0.70241155,
            0.70582646,
            0.78975465,
            0.82275505,
            0.82696029,
            0.64443225,
            1.0,
            0.93614266,
            0.80639361,
            0.84009605,
            0.84357514,
            0.96751232,
            0.93476538,
            0.97492023,
            0.97192739,
            0.80787976,
            0.81496993,
            1.0,
            0.89527742,
            0.73162798,
            0.79679711,
            0.66036524,
            0.97694864,
            0.98744056,
            0.87357972,
            1.0,
            0.97082534,
            0.70345496,
            0.75201523,
            1.0,
            0.85163498,
            0.90320349,
            0.66942185,
            0.89776876,
            0.90057817,
            0.90359755,
            0.8372048,
            0.92005773,
            1.0,
            0.87437662,
            0.90273752,
            0.94584826,
            0.83521008,
            0.80232881,
            0.93957194,
            0.93426468,
            0.91119811,
            0.83861244,
            0.98172006,
            0.95810095,
            0.95062588,
            0.7106746,
            0.6372667,
            0.79328708,
            0.7690881,
            0.77625798,
            0.63541245,
            1.0,
            0.95859494,
            0.95647289,
            1.0,
            0.79808235,
            0.80617519,
            0.89490709,
            0.5279218,
            0.78976534,
            0.89871825,
            0.74258897,
            0.80645395,
            0.84597894,
            0.95648949,
            0.98753256,
            0.73940152,
            0.86475276,
            0.94517446,
            0.84045925,
            0.90775333,
            0.92948975,
            0.98800649,
            1.0,
            0.83627195,
            0.73894595,
            0.63633952,
            1.0,
            0.88301667,
            0.64008875,
            0.80101492,
            0.87913001,
            1.0,
            0.73581143,
            0.72784875,
            0.79223485,
            0.78735222,
            0.6856236,
            0.6752988,
            0.64087537,
            0.82316701,
            0.77572879,
            0.78031926,
            0.59436061,
            0.68402819,
            0.86777933,
            0.91063554,
            0.83571488,
            0.89898732,
            0.95139503,
            0.69154096,
            0.81206258,
            0.99227522,
            0.88937171,
            0.84647783,
            0.92765317,
            0.78998475,
            0.85433507,
            0.70077641,
            0.8425941,
            0.95667893,
            0.74140648,
            0.86567944,
            0.91929401,
            0.8473404,
            0.89644064,
            0.68208975,
            0.58596388,
            1.0,
            1.0,
            0.96907005,
            1.0,
            0.91769872,
            1.0,
            0.94234121,
            0.84162625,
            0.99299476,
            0.99323255,
            0.95941706,
            0.96517078,
            0.6984843,
            0.75772561,
            0.72360221,
            0.7114211,
            0.93239734,
            0.6676879,
            0.71149838,
            0.9488947,
            0.92633161,
            0.88667206,
            0.84696393,
            0.97957324,
            0.85187874,
            0.82767376,
            0.68357102,
            0.88356478,
            0.82058866,
            0.84088232,
            0.80505687,
            0.74263372,
            0.96330225,
            0.81122526,
            0.97732606,
            0.81766102,
            1.0,
            0.80368522,
            1.0,
            0.98585367,
            1.0,
            1.0,
            1.0,
            0.97535809,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.95669403,
            1.0,
            1.0,
            1.0,
            0.77950506,
            1.0,
            1.0,
            1.0,
            0.89432517,
            0.93685824,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.93789278,
            1.0,
            1.0,
            0.94356552,
            1.0,
            1.0,
            0.85235718,
            1.0,
            1.0,
            0.88928199,
            0.94854146,
            1.0,
            0.99550767,
            1.0,
            0.97569979,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.99121419,
            1.0,
            0.88386874,
            1.0,
            1.0,
            0.91644138,
            0.80333248,
            1.0,
            1.0,
            1.0,
            0.98983401,
            1.0,
            0.9717509,
            0.82039489,
            1.0,
            0.94390571,
            0.9484658,
            0.8761276,
            0.92580306,
            0.80282177,
            0.92771803,
            0.58700293,
            1.0,
            0.93626793,
            1.0,
            1.0,
            1.0,
            0.96986405,
            0.89261102,
            0.91914921,
            0.99464531,
            1.0,
            1.0,
            0.93279844,
            0.91802935,
            1.0,
            0.9350915,
            1.0,
            0.89185836,
            1.0,
            1.0,
            0.92331776,
            1.0,
            0.8354331,
            1.0,
            0.88143848,
            1.0,
            0.95332445,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.76501216,
            1.0,
            1.0,
            1.0,
            0.96354877,
            1.0,
            1.0,
            0.95593903,
            1.0,
            0.96292347,
            1.0,
            1.0,
            0.97534517,
            1.0,
            1.0,
            1.0,
            0.7107829,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.78707103,
            1.0,
            0.89729783,
            1.0,
            1.0,
            1.0,
            0.86433533,
            1.0,
            0.96991815,
            1.0,
            1.0,
            0.82904289,
            1.0,
            1.0,
            1.0,
            0.96681601,
            0.99977553,
            1.0,
            0.98330292,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.83349143,
            1.0,
            0.79176781,
            0.93452811,
            1.0,
            0.94223934,
            0.75377397,
            0.95858912,
            0.98333409,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.90644323,
            0.9079627,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.85575121,
            1.0,
            0.93501594,
            1.0,
            0.86584932,
            0.91581484,
            0.93548971,
            0.87637545,
            0.9552769,
            0.96843113,
            0.9337846,
            1.0,
            0.98546695,
            0.89843535,
            1.0,
            1.0,
            1.0,
            1.0,
            0.99679893,
            1.0,
            1.0,
            1.0,
            1.0,
            0.77079489,
            1.0,
            0.86622619,
            1.0,
            1.0,
            0.75200241,
            0.97770602,
            1.0,
            0.79461941,
            0.96148279,
            1.0,
            1.0,
            0.96579335,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.94393188,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.8186055,
            1.0,
            1.0,
            1.0,
            0.85115469,
            1.0,
            1.0,
            0.77145568,
            1.0,
            1.0,
            1.0,
            0.90135348,
            1.0,
            1.0,
            0.95302407,
            0.96867769,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.96924086,
            1.0,
            1.0,
            1.0,
            1.0,
            0.81912485,
            0.94537143,
            0.70291839,
            1.0,
            1.0,
            1.0,
            0.72480968,
            1.0,
            0.90947002,
            1.0,
            1.0,
            1.0,
            0.96801615,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.92188403,
            1.0,
            1.0,
            1.0,
            1.0,
            0.82295543,
            1.0,
            1.0,
            1.0,
            0.8501635,
            1.0,
            1.0,
            1.0,
            1.0,
            0.89624422,
            0.85848622,
            0.95053561,
            0.95296354,
            0.87971325,
            0.98284737,
            0.92327544,
            0.92483225,
            1.0,
            0.88017325,
            0.80886995,
            0.83972504,
            1.0,
            0.92688765,
            1.0,
            1.0,
            1.0,
            0.98992881,
            1.0,
            1.0,
            1.0,
            0.93015352,
            1.0,
            0.95444506,
            0.9672435,
            1.0,
            0.95102686,
            1.0,
            0.91988856,
            1.0,
            1.0,
            0.97009789,
            0.92944591,
            1.0,
            1.0,
            1.0,
            0.85499656,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.87154227,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.88211131,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.92464123,
            1.0,
            0.99661457,
            1.0,
            0.84584313,
            1.0,
            0.97535082,
            0.97740287,
            1.0,
            0.98958201,
            0.96821985,
            0.88238873,
            1.0,
            0.77599978,
            1.0,
            1.0,
            1.0,
            0.99264879,
            0.95770217,
            0.95364037,
            1.0,
            1.0,
            1.0,
            0.83596151,
            1.0,
            1.0,
            1.0,
            0.78513602,
            0.90889324,
            0.91628133,
            0.95492869,
            0.74511714,
            1.0,
            0.72619991,
            1.0,
            1.0,
            0.95655884,
            1.0,
            1.0,
            1.0,
            0.93753064,
            1.0,
            0.99758679,
            1.0,
            0.95225223,
            1.0,
            1.0,
            1.0,
            0.89167332,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.98842282,
            1.0,
            1.0,
            0.99653375,
            1.0,
            0.89767944,
            1.0,
            1.0,
            1.0,
            0.74898866,
            1.0,
            0.80626686,
            1.0,
            1.0,
            0.77066268,
            1.0,
            1.0,
            0.9760065,
            1.0,
            0.9592055,
            0.99103529,
            1.0,
            0.96686565,
            0.8496404,
            1.0,
            1.0,
            1.0,
            0.89482071,
            0.85919248,
            0.94259465,
            0.88351229,
            0.95801952,
            1.0,
            0.87818858,
            1.0,
            0.97824272,
            1.0,
            1.0,
            0.78102296,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.89836187,
            1.0,
            0.85010055,
            1.0,
            0.99244402,
            0.99886377,
            0.95596084,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.84724097,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.84654802,
            1.0,
            0.93840956,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.98423568,
            1.0,
            1.0,
            0.85328615,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.86266823,
            1.0,
            0.85573673,
            1.0,
            0.92527062,
            1.0,
            0.97268997,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.8790453,
            1.0,
            1.0,
            0.87351949,
            0.98328233,
            1.0,
            1.0,
            0.82675881,
            0.82955121,
            1.0,
            0.87568707,
            0.87974026,
            1.0,
            0.78836149,
            1.0,
            0.99141836,
            1.0,
            0.99279666,
            0.9771574,
            1.0,
            0.98152213,
            0.96842515,
            0.97790357,
            0.9689277,
            1.0,
            1.0,
            1.0,
            0.84647616,
            1.0,
            0.74729587,
            1.0,
            0.69805342,
            1.0,
            1.0,
            0.73376431,
            1.0,
            0.9384597,
            1.0,
            1.0,
            1.0,
            0.93339677,
            1.0,
            0.98311293,
            0.88020688,
            1.0,
            0.95082164,
            1.0,
            0.91086339,
            0.64301317,
            1.0,
            0.9330264,
            0.82154514,
            0.72289284,
            1.0,
            1.0,
            1.0,
            1.0,
            0.84819651,
            0.89914861,
            1.0,
            0.93635661,
            0.88683169,
            0.89241965,
            0.83096562,
            1.0,
            0.89729061,
            0.92362038,
            1.0,
            1.0,
            1.0,
            0.89482002,
            1.0,
            0.89730852,
            0.89756766,
            1.0,
            0.77768842,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.94118061,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.84919162,
            1.0,
            0.82467977,
            1.0,
            0.93242728,
            1.0,
            0.9120965,
            1.0,
            0.91008305,
            1.0,
            1.0,
            1.0,
            1.0,
            0.99531883,
            1.0,
            0.9540713,
            1.0,
            1.0,
            0.97842301,
            0.89469529,
            0.84946773,
            0.76275054,
            0.92716118,
            0.98731427,
            0.97827231,
            0.99736916,
            0.82774057,
            0.72529299,
            1.0,
            0.92612484,
            1.0,
            1.0,
            1.0,
            1.0,
            0.89554901,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.85747075,
            0.90179343,
            1.0,
            1.0,
            0.93955803,
            1.0,
            0.95251858,
            1.0,
            1.0,
            1.0,
            0.97251589,
            0.93015267,
            1.0,
            1.0,
            1.0,
            0.82734209,
            0.88887902,
            1.0,
            1.0,
            0.87009954,
            0.92715574,
            1.0,
            1.0,
            1.0,
            1.0,
            0.98199821,
            1.0,
            1.0,
            0.82092081,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            0.89416035,
            1.0,
            1.0,
            1.0,
            1.0,
            0.94976993,
            1.0,
            1.0,
            0.97222653,
            1.0,
            0.88835265,
            1.0,
            0.65458393,
            0.91062618,
            0.5744909,
            0.84429324,
            0.64571623,
            0.63231415,
            0.9408575,
            0.72070201,
            0.78910049,
            0.78507824,
            1.0,
            0.74716094,
            0.71654478,
            0.95559957,
            0.6374876,
            0.85494312,
            0.61643499,
            0.74613966,
            0.93002236,
            0.71030122,
            0.77391956,
            0.71506122,
            1.0,
            0.77275798,
            0.75042483,
            0.79104705,
            0.86028455,
            0.69222343,
            0.84350317,
            0.79996745,
            0.77226398,
            0.87336337,
            0.66694974,
            0.70754505,
            0.65323488,
            0.39807376,
            0.5833298,
            0.88623645,
            0.96892532,
            0.76764557,
            0.92443381,
            0.9007725,
            0.63902856,
            0.48187771,
            0.55375388,
            0.71908651,
            0.67081637,
            0.72122334,
        ]
    )
    labels = np.array(
        [
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [0],
            [3],
            [2],
            [1],
            [0],
            [2],
            [1],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [1],
            [2],
            [2],
            [2],
            [1],
            [1],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [1],
            [1],
            [2],
            [1],
            [2],
            [1],
            [2],
            [2],
            [1],
            [1],
            [2],
            [1],
            [1],
            [1],
            [2],
            [2],
            [1],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [1],
            [1],
            [1],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [1],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [1],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [1],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [1],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [1],
            [2],
            [1],
            [2],
            [1],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [1],
            [1],
            [1],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [1],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [1],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [1],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [1],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [1],
            [2],
            [1],
            [2],
            [1],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [1],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [2],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [3],
            [3],
            [3],
            [3],
            [0],
            [3],
            [3],
            [0],
            [0],
            [0],
            [3],
            [0],
            [3],
            [3],
            [3],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [3],
            [0],
            [3],
            [0],
            [0],
            [0],
            [0],
            [0],
            [3],
            [3],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [3],
            [0],
            [0],
            [3],
            [3],
            [0],
            [0],
            [3],
            [0],
            [0],
            [3],
            [0],
            [0],
            [3],
            [3],
            [3],
            [3],
            [0],
            [3],
            [0],
            [0],
            [3],
            [0],
            [0],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [3],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
            [0],
        ]
    )
    return {"scores": scores, "labels": labels}


@pytest.mark.unit
@pytest.mark.parametrize(
    "scores, labels, expected_acer, thresholds, meta_label_info, expected_max_apcer_label, expected_acer_per_label, expected_apcer_per_label",
    [
        (
            np.array([0.5, 0.6, 0.2, 0.0, 0.0]),
            np.array([1, 2, 2, 0, 0]),
            0.0,
            {"eer": 0.15},
            {"print": [1], "replay": [2]},
            "print",
            {"print": 0.0, "replay": 0.0},
            {"print": 0.0, "replay": 0.0},
        ),
        (
            np.array([0.0, 0.0, 0.1, 0.6, 0.2]),
            np.array([0, 0, 1, 2, 2]),
            50.0,
            {"eer": 0.15},
            {"print": [1], "replay": [2]},
            "print",
            {"print": 50.0, "replay": 0.0},
            {"print": 100.0, "replay": 0.0},
        ),
        (
            np.array([0.1, 0.2, 0.12, 0.25, 0.28, 0.3, 0.22, 0.2, 0.5, 0.6, 0.7, 0.8]),
            np.array([0, 0, 1, 2, 2, 2, 3, 3, 4, 4, 5, 5]),
            37.5,
            {"eer": 0.15},
            {"print": [1, 2], "replay": [3, 4], "mask": [5]},
            "print",
            {"print": 37.5, "replay": 25.0, "mask": 25.0},
            {"print": 25.0, "replay": 0.0, "mask": 0.0},
        ),
    ],
)
def test_should_compute_indepth_error_rates_analysis_correctly(
    scores,
    labels,
    expected_acer,
    thresholds,
    meta_label_info,
    expected_max_apcer_label,
    expected_acer_per_label,
    expected_apcer_per_label,
):

    indepth_error_rates_result = indepth_error_rates_analysis(
        scores, labels, thresholds, meta_label_info
    )

    indepth_error_rates_result_eer = indepth_error_rates_result["eer"]

    assert pytest.approx(expected_acer, 0.1) == indepth_error_rates_result_eer.acer
    assert expected_max_apcer_label == indepth_error_rates_result_eer.max_apcer_label
    for key, value in expected_acer_per_label.items():
        assert (
            pytest.approx(value, 0.1)
            == indepth_error_rates_result_eer.acer_per_label[key]
        )

    for key, value in expected_apcer_per_label.items():
        assert (
            pytest.approx(value, 0.1)
            == indepth_error_rates_result_eer.apcer_per_label[key]
        )


@pytest.mark.unit
def test_should_throw_an_exception_when_input_is_an_invalid_meta_label_info():

    scores = np.array([0.1, 0.2, 0.12, 0.25, 0.28, 0.3, 0.22, 0.2, 0.5, 0.6, 0.7, 0.8])
    labels = np.array([0, 0, 1, 2, 2, 2, 3, 3, 4, 4, 5, 5])
    thresholds = {"eer": 0.15}
    invalid_meta_label_info = {"print": [1], "replay": [3, 4], "mask": [5]}
    pytest.raises(
        ValueError,
        lambda: indepth_error_rates_analysis(
            scores, labels, thresholds, invalid_meta_label_info
        ),
    )


@pytest.mark.unit
def test_should_compare_acer_performance_with_indepth_error_rates_analysis_specific_meta_label_info():
    scores = np.array([0.1, 0.2, 0.12, 0.25, 0.28, 0.3, 0.22, 0.2, 0.5, 0.6, 0.7, 0.8])
    labels = np.array([0, 0, 1, 2, 2, 2, 3, 3, 4, 4, 5, 5])
    thresholds = {"eer": 0.15}
    specific_meta_label_info = {
        "print-lq": [1],
        "print-hq": [2],
        "replay-mobile": [3],
        "replay-laptop": [4],
        "maks": [5],
    }

    acer_result = 100.0 * acer(scores, labels, thresholds["eer"])

    specific_pai_indepth_error_rates_result = indepth_error_rates_analysis(
        scores, labels, thresholds, specific_meta_label_info
    )

    specific_pai_indepth_error_rates_result_eer = specific_pai_indepth_error_rates_result[
        "eer"
    ]

    assert acer_result == specific_pai_indepth_error_rates_result_eer.acer
    assert specific_pai_indepth_error_rates_result_eer.acer_per_label == {
        "print-lq": 75.0,
        "print-hq": 25.0,
        "replay-mobile": 25.0,
        "replay-laptop": 25.0,
        "maks": 25.0,
    }
    assert specific_pai_indepth_error_rates_result_eer.max_apcer_label == "print-lq"
    assert specific_pai_indepth_error_rates_result_eer.apcer_per_label == {
        "print-lq": 100.0,
        "print-hq": 0.0,
        "replay-mobile": 0.0,
        "replay-laptop": 0.0,
        "maks": 0.0,
    }
    assert specific_pai_indepth_error_rates_result_eer.percentage_per_label == {
        "print-lq": 10.0,
        "print-hq": 30.0,
        "replay-mobile": 20.0,
        "replay-laptop": 20.0,
        "maks": 20.0,
    }

    assert specific_pai_indepth_error_rates_result_eer.acer == 75
    assert specific_pai_indepth_error_rates_result_eer.wacer == 30


@pytest.mark.unit
def test_should_compare_acer_performance_with_indepth_error_rates_analyisis_aggregate_meta_label_info():
    scores = np.array([0.1, 0.2, 0.12, 0.25, 0.28, 0.3, 0.22, 0.2, 0.5, 0.6, 0.7, 0.8])
    labels = np.array([0, 0, 1, 2, 2, 2, 3, 3, 4, 4, 5, 5])
    thresholds = {"eer": 0.15}
    aggregate_meta_label_info = {"print": [1, 2], "replay": [3, 4], "maks": [5]}

    acer_result = 100.0 * acer(scores, labels, thresholds["eer"])

    indepth_error_rates_result = indepth_error_rates_analysis(
        scores, labels, thresholds, aggregate_meta_label_info
    )

    indepth_error_rates_result_eer = indepth_error_rates_result["eer"]

    assert acer_result != indepth_error_rates_result_eer.acer
    assert indepth_error_rates_result_eer.acer_per_label == {
        "print": 37.5,
        "replay": 25,
        "maks": 25,
    }
    assert indepth_error_rates_result_eer.max_apcer_label == "print"
    assert indepth_error_rates_result_eer.apcer_per_label == {
        "print": 25,
        "replay": 0.0,
        "maks": 0.0,
    }
    assert indepth_error_rates_result_eer.percentage_per_label == {
        "print": 40.0,
        "replay": 40.0,
        "maks": 20.0,
    }
    assert indepth_error_rates_result_eer.acer == 37.5
    assert indepth_error_rates_result_eer.wacer == 30


@pytest.mark.unit
@pytest.mark.parametrize(
    "meta_label_info",
    [
        {
            "print-lq": [1],
            "print-hq": [2],
            "replay-mobile": [3],
            "replay-laptop": [4],
            "maks": [5],
        },
        {"print": [1, 2], "replay": [3, 4], "maks": [5]},
    ],
)
def test_should_obtain_indepth_error_rates_analysis_result_and_dump_to_dict(
    meta_label_info
):
    scores = np.array([0.1, 0.2, 0.12, 0.25, 0.28, 0.3, 0.22, 0.2, 0.5, 0.6, 0.7, 0.8])
    labels = np.array([0, 0, 1, 2, 2, 2, 3, 3, 4, 4, 5, 5])
    thresholds = {"eer": 0.15}

    indepth_error_rates = indepth_error_rates_analysis(
        scores, labels, thresholds, meta_label_info
    )

    acer_analysis_dict = indepth_error_rates["eer"].to_dict()

    assert isinstance(acer_analysis_dict, dict)
    for key in [
        "acer",
        "bpcer",
        "max_apcer_label",
        "apcer_per_label",
        "acer_per_label",
        "num_samples_per_label",
        "percentage_per_label",
        "wacer",
        "weighted_apcer_per_label",
    ]:
        assert key in acer_analysis_dict


@pytest.mark.unit
def test_should_x_when_there_is_not_a_label_specified_in_meta_info_label():
    scores = np.array([0.1, 0.2, 0.12, 0.25, 0.28, 0.3, 0.22, 0.2, 0.7, 0.8])
    labels = np.array([0, 0, 1, 2, 2, 2, 3, 3, 5, 5])
    thresholds = {"eer": 0.15}
    specific_meta_label_info = {
        "print-lq": [1],
        "print-hq": [2],
        "replay-mobile": [3],
        "replay-laptop": [4],
        "maks": [5],
    }

    acer_result = 100.0 * acer(scores, labels, thresholds["eer"])

    indepth_error_rates_result = indepth_error_rates_analysis(
        scores, labels, thresholds, specific_meta_label_info
    )
    indepth_error_rates_result_eer = indepth_error_rates_result["eer"]

    assert acer_result == indepth_error_rates_result_eer.acer
    assert indepth_error_rates_result_eer.acer_per_label == {
        "print-lq": 75.0,
        "print-hq": 25.0,
        "replay-mobile": 25.0,
        "maks": 25.0,
    }
    assert indepth_error_rates_result_eer.max_apcer_label == "print-lq"
    assert indepth_error_rates_result_eer.apcer_per_label == {
        "print-lq": 100.0,
        "print-hq": 0.0,
        "replay-mobile": 0.0,
        "maks": 0.0,
    }
    assert indepth_error_rates_result_eer.percentage_per_label == {
        "print-lq": 12.5,
        "print-hq": 37.5,
        "replay-mobile": 25.0,
        "replay-laptop": 0.0,
        "maks": 25.0,
    }

    assert indepth_error_rates_result_eer.acer == 75
    assert indepth_error_rates_result_eer.wacer == 31.25


@pytest.mark.unit
@pytest.mark.parametrize(
    "scores, labels, expected_acer, thresholds, meta_label_info, expected_bpcer",
    [
        (
            np.array([0.5, 0.6, 0.2, 0.0, 0.06, 0.12]),
            np.array([1, 2, 2, 0, 0, 0]),
            0.0,
            {"eer": 0.15, "apcer_05": 0.10, "apcer_10": 0.05},
            {"print": [1], "replay": [2]},
            {"eer": 0.0, "apcer_05": 33.33, "apcer_10": 66.66},
        )
    ],
)
def test_should_compute_indepth_error_rates_analysis_correctly_with_several_working_points(
    scores, labels, expected_acer, thresholds, meta_label_info, expected_bpcer
):

    indepth_error_rates_results = indepth_error_rates_analysis(
        scores, labels, thresholds, meta_label_info
    )

    for (
        working_point,
        indepth_error_rates_result,
    ) in indepth_error_rates_results.items():
        assert (
            pytest.approx(expected_bpcer[working_point], 0.1)
            == indepth_error_rates_result.bpcer
        )


@pytest.mark.unit
@pytest.mark.parametrize(
    "scores, labels, expected_acer, thresholds, meta_label_info, expected_max_apcer_label, expected_acer_per_label, expected_apcer_per_label",
    [
        (
            np.array([0.5, 0.6, 0.2, 0.0, 0.0]),
            np.array([1, 2, 2, 0, 0]),
            0.0,
            {"eer": 0.15},
            {"print": [1], "replay": [2]},
            "print",
            {"print": 0.0, "replay": 0.0},
            {"print": 0.0, "replay": 0.0},
        ),
        (
            np.array([0.0, 0.0, 0.1, 0.6, 0.2]),
            np.array([0, 0, 1, 2, 2]),
            50.0,
            {"eer": 0.15},
            {"print": [1], "replay": [2]},
            "print",
            {"print": 50.0, "replay": 0.0},
            {"print": 100.0, "replay": 0.0},
        ),
        (
            np.array(
                [
                    0.1,
                    0.15,
                    0.16,
                    0.17,
                    0.18,
                    0.2,
                    0.12,
                    0.25,
                    0.28,
                    0.3,
                    0.22,
                    0.2,
                    0.5,
                    0.6,
                    0.7,
                    0.8,
                ]
            ),
            np.array([0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 3, 3, 4, 4, 5, 5]),
            45.83,
            {"eer": 0.15},
            {"print": [1, 2], "replay": [3, 4], "mask": [5]},
            "print",
            {"print": 45.83, "replay": 33.33, "mask": 33.33},
            {"print": 25.0, "replay": 0.0, "mask": 0.0},
        ),
    ],
)
def test_should_compute_indepth_error_rates_analysis_correctly_with_relative_workpoints(
    scores,
    labels,
    expected_acer,
    thresholds,
    meta_label_info,
    expected_max_apcer_label,
    expected_acer_per_label,
    expected_apcer_per_label,
):

    bpcer_fixing_working_points = [0.05, 0.10, 0.15]
    apcer_fixing_working_points = [0.05, 0.10, 0.15]

    indepth_error_rates_result = indepth_error_rates_analysis(
        scores,
        labels,
        thresholds,
        meta_label_info,
        bpcer_fixing_working_points,
        apcer_fixing_working_points,
    )

    indepth_error_rates_result_eer = indepth_error_rates_result["eer"]

    assert pytest.approx(expected_acer, 0.1) == indepth_error_rates_result_eer.acer
    assert expected_max_apcer_label == indepth_error_rates_result_eer.max_apcer_label
    for key, value in expected_acer_per_label.items():
        assert (
            pytest.approx(value, 0.1)
            == indepth_error_rates_result_eer.acer_per_label[key]
        )

    for key, value in expected_apcer_per_label.items():
        assert (
            pytest.approx(value, 0.1)
            == indepth_error_rates_result_eer.apcer_per_label[key]
        )

    assert list(
        indepth_error_rates_result_eer.relative_working_points["apcer"].keys()
    ) == ["bpcer_5", "bpcer_10", "bpcer_15"]
    assert list(
        indepth_error_rates_result_eer.relative_working_points["bpcer"].keys()
    ) == ["apcer_5", "apcer_10", "apcer_15"]

    assert (
        indepth_error_rates_result_eer.apcer_per_label_fixing_bpcer.keys()
        == meta_label_info.keys()
    )
    assert list(
        indepth_error_rates_result_eer.apcer_per_label_fixing_bpcer["print"].keys()
    ) == ["apcer_fixing_bpcer5", "apcer_fixing_bpcer10", "apcer_fixing_bpcer15"]

    assert list(
        indepth_error_rates_result_eer.relative_working_points["bpcer"].keys()
    ) == ["apcer_5", "apcer_10", "apcer_15"]


@pytest.mark.unit
def test_should_success_from_extreme_real_case(given_real_scores_and_labels):

    AGGREGATE_META_LABEL_INFO = {
        "print": [1, 2, 3],
        "replay": [4, 5, 6],
        "mask": [7, 8, 9],
        "makeup": [10, 11, 12],
        "partial": [13, 14, 15],
    }
    bpcer_fixing_working_points = [0.05, 0.1, 0.15, 0.2, 0.3, 0.4]
    apcer_fixing_working_points = [0.05, 0.1, 0.15, 0.2, 0.3, 0.4]

    _ = indepth_error_rates_analysis(
        given_real_scores_and_labels["scores"],
        given_real_scores_and_labels["labels"],
        {"eer": 0.8467167},
        AGGREGATE_META_LABEL_INFO,
        bpcer_fixing_working_points,
        apcer_fixing_working_points,
    )


@pytest.mark.unit
# @pytest.mark.skip
@pytest.mark.parametrize(
    "filename, working_point,expected_bpcer, bpcer_working_point",
    [
        (
            # "/Users/acosta/Downloads/Grandtest-Train-Type-PAI-I-Test-All_scores_test.npy",
            "tests/resources/real_scores/cross-dataset-test-siw-m_scores_test.npy",
            0.93400253,
            1.0,
            0.15,
        )
    ],
)
def test_should_success_from_real_case(
    filename, working_point, expected_bpcer, bpcer_working_point
):
    result = np.load(filename, allow_pickle=True).item()

    # from researchfellow import det_curve
    # det_curve(result, "deleteme.png")
    # wp = result = np.load("/Users/acosta/Downloads/working_point_eer_devel.npy", allow_pickle=True).item()

    scores = result["scores"]
    # labels = result["labels"]
    common_pai_labels = result["common_pai_labels"]

    # AGGREGATE_META_LABEL_INFO = {'print': [1, 2, 3], 'replay': [4, 5, 6], 'mask': [7, 8, 9], 'makeup': [10, 11, 12],
    #                              'partial': [13, 14, 15, 16, 17]}

    SPECIFIC_META_LABEL_INFO = {
        "print_low_quality": [1],
        "print_medium_quality": [2],
        "print_high_quality": [3],
        "replay_low_quality": [4],
        "replay_medium_quality": [5],
        "replay_high_quality": [6],
        "mask_paper": [7],
        "mask_rigid": [8],
        "mask_silicone": [9],
        "makeup_cosmetic": [10],
        "makeup_impersonation": [11],
        "makeup_obfuscation": [12],
        "partial_funny_eyes": [13],
        "partial_periocular": [14],
        "partial_paper_glasses": [15],
        "partial_upper_half": [16],
        "partial_lower_half": [17],
    }

    bpcer_fixing_working_points = [0.05, 0.1, 0.15, 0.2, 0.3, 0.4]
    apcer_fixing_working_points = [0.05, 0.1, 0.15, 0.2, 0.3, 0.4]

    _ = indepth_error_rates_analysis(
        scores,
        common_pai_labels.flatten(),
        {"eer": working_point},
        SPECIFIC_META_LABEL_INFO,
        bpcer_fixing_working_points,
        apcer_fixing_working_points,
    )

    assert 1 == 1
